(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     29159,        739]
NotebookOptionsPosition[     28190,        707]
NotebookOutlinePosition[     28545,        723]
CellTagsIndexPosition[     28502,        720]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Copyright (C) 2016 Leo Fang <leofang@phy.duke.edu>

This program is free software. It comes without any warranty, to the extent \
permitted by applicable law. You can redistribute it and/or modify it under \
the terms of the WTFPL, Version 2, as published by Sam Hocevar. See the \
accompanying LICENSE file or http://www.wtfpl.net/ for more details.\
\>", "Text",
 CellChangeTimes->{{3.6867916083056583`*^9, 3.686791652714189*^9}}],

Cell["\<\
In this notebook, using the sample file k0a_0.5pi_on_new as an example, I \
demonstrate how to perform post-processing of the results generated by the \
FDTD code.\
\>", "Text",
 CellChangeTimes->{{3.709938310055749*^9, 3.7099384403921947`*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"read", " ", "input", " ", "parameters"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Import", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<../k0a_0.5pi_on_new\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.686073175448902*^9, 3.6860731799846363`*^9}, 
   3.686073211048245*^9, {3.686078115785614*^9, 3.686078116040594*^9}, {
   3.6861388618286867`*^9, 3.6861388655589933`*^9}, {3.686139507308385*^9, 
   3.6861395326663733`*^9}, {3.686141814988141*^9, 3.686141815736702*^9}, {
   3.686141883713605*^9, 3.686141885570209*^9}, {3.686791033014284*^9, 
   3.6867910337699223`*^9}, {3.709933904748562*^9, 3.7099339053833027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "set", " ", "the", " ", "input", " ", "parameters", " ", "in", " ", "the", 
    " ", "corresponding", " ", "symbols"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "//", "ToExpression"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.68613954692691*^9, 3.6861395495793467`*^9}, {
  3.686141272760371*^9, 3.686141307467169*^9}, {3.7099338956404667`*^9, 
  3.709933924876278*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "setup", " ", "based", " ", "on", " ", "input", " ", "parameters"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Xmin", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"Nx", "+", "nx", "+", "1"}], ")"}]}], "Delta"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xmax", "=", 
     RowBox[{
      RowBox[{"(", "Nx", ")"}], "Delta"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qubit1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "nx"}], "/", "2"}], "*", "Delta"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qubit2", "=", 
     RowBox[{
      RowBox[{"nx", "/", "2"}], "*", "Delta"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6860638168369207`*^9, 3.686063849842124*^9}, {
  3.686072083536743*^9, 3.6860720837919903`*^9}, {3.6860725456389503`*^9, 
  3.686072545911799*^9}, {3.6860726842455063`*^9, 3.68607268486786*^9}, {
  3.686072841665362*^9, 3.686072845791586*^9}, {3.686073248132491*^9, 
  3.686073253618965*^9}, {3.7099339824526176`*^9, 3.7099339966957808`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "read", " ", "the", " ", "absolute", " ", "value", " ", "of", " ", "the", 
     " ", "computed", " ", "two"}], "-", 
    RowBox[{"photon", " ", "wavefunction"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Chi]", "=", 
    RowBox[{"ReadList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<../k0a_0.5pi_on_new.abs_chi.out\>\""}], ",", "Number", ",", 
      RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.68590352509446*^9, 3.6859035460681257`*^9}, {
   3.68590361901433*^9, 3.685903619738954*^9}, {3.685903839761773*^9, 
   3.6859038411442842`*^9}, {3.686063652773052*^9, 3.686063665892928*^9}, {
   3.6860718382624063`*^9, 3.686071843732375*^9}, {3.686072532934662*^9, 
   3.686072533189172*^9}, {3.686078120633203*^9, 3.6860781209370604`*^9}, {
   3.686138896349057*^9, 3.6861389003993607`*^9}, {3.686139565370081*^9, 
   3.686139576468504*^9}, {3.686139697280517*^9, 3.6861396995838547`*^9}, 
   3.686140777085886*^9, {3.6861414028791428`*^9, 3.6861414090320187`*^9}, {
   3.6861420510353107`*^9, 3.686142058221898*^9}, {3.686262079584332*^9, 
   3.6862620839995604`*^9}, 3.686262179053034*^9, {3.6862622131112537`*^9, 
   3.6862622134960957`*^9}, {3.686262265233096*^9, 3.6862622851836767`*^9}, {
   3.686262449030333*^9, 3.686262452105942*^9}, {3.6862625205051327`*^9, 
   3.686262523464409*^9}, 3.686262598913431*^9, {3.686791161818397*^9, 
   3.68679117906805*^9}, {3.709934015275535*^9, 3.7099340445431557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"plot", " ", 
     SubscriptBox["g", "2"], 
     RowBox[{"(", 
      RowBox[{"\[Tau]", ",", "t"}], ")"}]}], "=", 
    RowBox[{"|", 
     RowBox[{"\[Chi]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "+", "\[CapitalDelta]"}], ",", 
        RowBox[{"a", "+", "\[CapitalDelta]", "+", "\[Tau]"}], ",", "t"}], 
       ")"}]}], 
     SuperscriptBox["|", "2"], " ", 
     RowBox[{
     "as", " ", "an", " ", "animation", " ", "in", " ", "time", " ", 
      "t"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", 
      RowBox[{"DataRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nx", "-", 
            RowBox[{"nx", "/", "2"}], "+", "1"}], ")"}], "Delta", "*", 
          "gamma"}]}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "All"}], "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"qubit2", "-", "qubit1"}], ")"}], "*", "gamma"}], "}"}], 
         ",", "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"\"\<t=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Nx", "+", 
            RowBox[{"nx", "/", "2"}], "+", "1"}], ")"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Tstep", "+", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}]}], "]"}], "<>", 
        "\"\<\[CapitalDelta]\>\""}]}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[CapitalGamma]\[Tau]\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(g\), \(2\)]\)(\[Tau],t)\>\""}], "}"}]}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "\[Chi]", "]"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.686068428525859*^9, 3.6860685172001266`*^9}, {
   3.6860686037371063`*^9, 3.68606860431188*^9}, {3.686068646279764*^9, 
   3.68606866770408*^9}, {3.686071343011095*^9, 3.686071363953788*^9}, {
   3.686071597551523*^9, 3.6860716053082533`*^9}, {3.686071917943413*^9, 
   3.686071922534156*^9}, {3.686072153953672*^9, 3.68607217443889*^9}, {
   3.686072734053317*^9, 3.6860727369014397`*^9}, {3.686073487891972*^9, 
   3.686073513027042*^9}, {3.686074368243916*^9, 3.686074430151237*^9}, {
   3.6860781534366007`*^9, 3.686078223830449*^9}, {3.686078350887472*^9, 
   3.686078364636075*^9}, {3.6860784096536827`*^9, 3.6860784398669147`*^9}, {
   3.6860785875718927`*^9, 3.686078614643306*^9}, {3.68607874515219*^9, 
   3.686078777134594*^9}, {3.686140823659737*^9, 3.686140845610243*^9}, {
   3.686140908084947*^9, 3.6861409389267387`*^9}, {3.6861409726545877`*^9, 
   3.686140976637426*^9}, {3.6861410708546352`*^9, 3.686141072554199*^9}, {
   3.6867912720961733`*^9, 3.686791357270578*^9}, 3.686791448532361*^9, {
   3.709934093332375*^9, 3.709934117210787*^9}, {3.709934157955696*^9, 
   3.709934220371911*^9}, {3.7099342520158997`*^9, 3.709934295834812*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"plot", " ", 
     SubscriptBox["g", "2"], 
     RowBox[{"(", 
      RowBox[{"\[Tau]", ",", "t"}], ")"}]}], "=", 
    RowBox[{"|", 
     RowBox[{"\[Chi]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "+", "\[CapitalDelta]"}], ",", 
        RowBox[{"a", "+", "\[CapitalDelta]", "+", "\[Tau]"}], ",", "t"}], 
       ")"}]}], 
     SuperscriptBox["|", "2"], " ", 
     RowBox[{"at", " ", "the", " ", "last", " ", "snapshot"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Chi]", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "^", "2"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Nx", "-", 
          RowBox[{"nx", "/", "2"}], "+", "1"}], ")"}], "Delta", "*", 
        "gamma"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"qubit2", "-", "qubit1"}], ")"}], "*", "gamma"}], "}"}], 
       ",", "None"}], "}"}]}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[CapitalGamma]\[Tau]\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(g\), \(2\)]\)(\[Tau])\>\""}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.686791477574132*^9, 3.686791520072109*^9}, {
  3.709934380598248*^9, 3.709934383681368*^9}, {3.709934423778079*^9, 
  3.709934441058042*^9}, {3.7099375585769377`*^9, 3.7099375592880993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Compare", " ", "with", " ", "the", " ", "result", " ", "obtained", " ", 
      "using", " ", "scattering", " ", "theory"}], ";", " ", 
     RowBox[{"see", " ", "PRA", " ", "91"}]}], ",", 
    RowBox[{"053845", " ", 
     RowBox[{"(", "2015", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{"%", ",", 
    GraphicsBox[{{}, 
      {RGBColor[0, 0, 1], PointBox[CompressedData["
1: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
        "]]}, {}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     AxesLabel->{None, None},
     AxesOrigin->{0., 0.0012264070623170195`},
     Method->{},
     PlotRangeClipping->True]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.709934446049724*^9, 3.709934473469551*^9}, {
  3.709937375820607*^9, 3.7099373791484957`*^9}, {3.7099374387636747`*^9, 
  3.709937449270643*^9}, {3.709937508864091*^9, 3.7099375115323553`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "next", " ", "file", " ", "is", " ", "memory", " ", 
     "consuming"}], ",", " ", 
    RowBox[{"so", " ", "clear", " ", "some", " ", "memory", " ", "first"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Clear", "[", "\[Chi]", "]"}]}]], "Input",
 CellChangeTimes->{{3.686791556068719*^9, 3.686791559499723*^9}, {
  3.686792053703658*^9, 3.686792077480363*^9}, {3.7099344014627523`*^9, 
  3.709934403620984*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"read", " ", "computed", " ", "wavefunctions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bR", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<../k0a_0.5pi_on_new.re.out\>\""}], ",", "Number", ",", 
       RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{"real", " ", "part"}], "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bI", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<../k0a_0.5pi_on_new.im.out\>\""}], ",", "Number", ",", 
       RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], 
    RowBox[{"(*", " ", 
     RowBox[{"imaginary", " ", "part"}], "*)"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.68590352509446*^9, 3.6859035460681257`*^9}, {
   3.68590361901433*^9, 3.685903619738954*^9}, {3.685903839761773*^9, 
   3.6859038411442842`*^9}, {3.686063652773052*^9, 3.686063665892928*^9}, {
   3.6860718382624063`*^9, 3.686071843732375*^9}, {3.686072532934662*^9, 
   3.686072533189172*^9}, {3.686078120633203*^9, 3.6860781209370604`*^9}, {
   3.686138896349057*^9, 3.6861389003993607`*^9}, {3.686139565370081*^9, 
   3.686139576468504*^9}, {3.686139697280517*^9, 3.6861396995838547`*^9}, 
   3.686140777085886*^9, {3.6861414028791428`*^9, 3.6861414090320187`*^9}, {
   3.6861420510353107`*^9, 3.686142058221898*^9}, {3.686262079584332*^9, 
   3.6862620839995604`*^9}, 3.686262179053034*^9, {3.6862622131112537`*^9, 
   3.6862622134960957`*^9}, {3.686262265233096*^9, 3.6862622851836767`*^9}, {
   3.686262449030333*^9, 3.686262452105942*^9}, {3.6862625205051327`*^9, 
   3.686262523464409*^9}, 3.686262598913431*^9, {3.686791671165701*^9, 
   3.686791672970572*^9}, {3.709934492833997*^9, 3.70993449342575*^9}, {
   3.709936610961955*^9, 3.709936678934371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"construct", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Psi]", "=", 
    RowBox[{"bR", "+", 
     RowBox[{"I", "*", "bI"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.709936733080463*^9, 3.709936748497189*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"set", " ", "the", " ", "fraction", " ", 
    RowBox[{"(", 
     RowBox[{"10", "%"}], ")"}], " ", "for", " ", "plotting", " ", "blow"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ny", "=", 
    RowBox[{"1", "/", "10"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.686068389047533*^9, 3.686068393448057*^9}, {
  3.686069006488678*^9, 3.686069006648552*^9}, {3.686072567955511*^9, 
  3.686072568193915*^9}, {3.68607286537397*^9, 3.686072866508905*^9}, {
  3.686073277604354*^9, 3.6860732851089907`*^9}, {3.709934862022008*^9, 
  3.7099348736605253`*^9}, {3.709934915140726*^9, 3.7099349154558764`*^9}, {
  3.709937604975973*^9, 3.709937629325108*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "plot", " ", "the", " ", "real", " ", "part", " ", "of", " ", "the", " ", 
    "first", " ", "10", "%", " ", 
    RowBox[{"(", 
     RowBox[{"in", " ", "time"}], ")"}], " ", "solution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{
    RowBox[{"bR", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"ny", "*", 
         RowBox[{"Length", "[", "bR", "]"}]}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qubit1", ",", "Xmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Ceiling", "[", 
             RowBox[{"ny", "*", 
              RowBox[{"Length", "[", "bR", "]"}]}], "]"}], "-", "1"}], ")"}], 
          "*", 
          RowBox[{"(", 
           RowBox[{"Tstep", "+", "1"}], ")"}], "*", "Delta"}]}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Warm\>\""}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"MaxPlotPoints", "\[Rule]", "200"}]}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzZVy5v7ssteOn+XWfgDRSsqexnOAdA/bbDC95fVb
SxCd0tJmA6L15i90BdErfh8D07EPVseCaKmOnWC6+PP6C3OBtEvvAzAt1bvt
FYhu8Vz4GkTf+LTjG4g+V/gVTEvPa4iYBzI/pRtMK4RpVS4A0jvazVpA9CJT
t24Qvfl3bx+IfsUec30RkPbgigPT4bEzNxwE0trTVoHpTIvblcpLXjsuyZOq
AdEbzy1tAtENk4qaQXTI3+vdIHraplO9INqjT2gaiBa7dBFML+PsmA+mm6oW
gOiI5r6VIJrrziwwzfLBrFMFSO9U8wLTANiPq8g=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "plot", " ", "the", " ", "absolute", " ", "value", " ", "square", " ", 
    "of", " ", "the", " ", "first", " ", "10", "%", " ", 
    RowBox[{"(", 
     RowBox[{"in", " ", "time"}], ")"}], " ", "solution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"ny", "*", 
           RowBox[{"Length", "[", "bR", "]"}]}], "]"}]}], "]"}], "]"}], "]"}],
      "^", "2"}], ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qubit1", ",", "Xmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Ceiling", "[", 
             RowBox[{"ny", "*", 
              RowBox[{"Length", "[", "bR", "]"}]}], "]"}], "-", "1"}], ")"}], 
          "*", 
          RowBox[{"(", 
           RowBox[{"Tstep", "+", "1"}], ")"}], "*", "Delta"}]}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Warm\>\""}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"MaxPlotPoints", "\[Rule]", "200"}]}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzZVy5v7ssteOn+XWfgDRSsqexnOAdA/bbDC95fVb
SxCd0tJmA6L15i90BdErfh8D07EPVseCaKmOnWC6+PP6C3OBtEvvAzAt1bvt
FYhu8Vz4GkTf+LTjG4g+V/gVTEvPa4iYBzI/pRtMK4RpVS4A0jvazVpA9CJT
t24Qvfl3bx+IfsUec30RkPbgigPT4bEzNxwE0trTVoHpTIvblcpLXjsuyZOq
AdEbzy1tAtENk4qaQXTI3+vdIHraplO9INqjT2gaiBa7dBFML+PsmA+mm6oW
gOiI5r6VIJrrziwwzfLBrFMFSKd//NkFovO+3+sD0adc1k0E0QABVbX4
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "plot", " ", "the", " ", "real", " ", "part", " ", "of", " ", "the", " ", 
    "entire", " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{"bR", ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qubit1", ",", "Xmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "bR", "]"}], "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"Tstep", "+", "1"}], ")"}], "*", "Delta"}]}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Warm\>\""}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"MaxPlotPoints", "\[Rule]", "200"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.70993495538138*^9, 3.709934970854773*^9}, {
  3.709936601624748*^9, 3.709936602237705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "plot", " ", "the", " ", "absolute", " ", "value", " ", "square", " ", 
    "of", " ", "the", " ", "entire", " ", "solution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ListDensityPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "\[Psi]", "]"}], "^", "2"}], ",", 
    RowBox[{"DataRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qubit1", ",", "Xmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "bR", "]"}], "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"Tstep", "+", "1"}], ")"}], "*", "Delta"}]}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Warm\>\""}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"MaxPlotPoints", "\[Rule]", "200"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.70993495538138*^9, 3.709934970854773*^9}, {
  3.709936601624748*^9, 3.709936602237705*^9}, {3.709936860474176*^9, 
  3.7099368730578547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "show", " ", "the", " ", "propagation", " ", "of", " ", "the", " ", "real",
     " ", "part", " ", "of", " ", "the", " ", "wave", " ", "as", " ", "an", 
    " ", "animation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"bR", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"DataRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"qubit1", ",", "Xmax"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "8"}], ",", "8"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"qubit1", ",", "qubit2"}], "}"}], ",", "None"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"\"\<t=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Tstep", "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "]"}], "<>", 
        "\"\<\[CapitalDelta]\>\""}]}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<Re[\[Psi](x,t)]\>\""}], "}"}]}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "bR", "]"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxU8oQ3EAB/DXUmscRCvUDuTlT21RFjf1DuQgxUGZlMa4sVY2JWryPOJg
bNoFM0wuSpaVttWypPAuW2v+bFmcPIw31sw0v6/Dp0+VdrxHJ6EoqpzAkdBK
xaZRYPSjLhoPrpsa8Et28f9w6kKNQ5yxBT9pHtgt8hg7s4DlrqM93Bw7cGF9
o/8a82XdPJ6aaxXwUBH/is/dgSYH2R5VqLFsKWfBXKzShut5KbVNTkaCUuzM
qG6c5MK1bAIrR+4/8KnGmsKZZ/U3Dvp+cljsNBTvkNO2cCn2x+lqbO+ia7FF
8WUIkBXc8QR+9MxO4+j+gBlrRSuLL3Xyeazsu7NgyluyitPJ37a8SWDqCkzt
uCYv02Jx8nYYxx3uE3pXYD7fez14Q9XhxZJDtw8n3vrP8HJKuMJ/ImDZxw==

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "show", " ", "the", " ", "propagation", " ", "of", " ", "the", " ", 
    "absolute", " ", "value", " ", "of", " ", "the", " ", "wave", " ", "as", 
    " ", "an", " ", "animation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Abs", "@", 
       RowBox[{"\[Psi]", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"DataRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"qubit1", ",", "Xmax"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "7.5"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"qubit1", ",", "qubit2"}], "}"}], ",", "None"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"\"\<t=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Tstep", "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], "]"}], "<>", 
        "\"\<\[CapitalDelta]\>\""}]}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<Re[\[Psi](x,t)]\>\""}], "}"}]}]}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "bR", "]"}], ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxU0og3EAB+C3pdY4+Gil1Q7kzUdtURblsNqBHKQ4KJPSmN1YK5uSFZmR
krFpF8wwuShZVtqWZWmlvQdba8yWxUFenxtrZpr/z+HpqVaM9yo5FEUJCBwJ
rQg2taxMrXLQeGhd14ifc4v/h9MBCQ4Zta34QX5n2CKPGfQLmO842sMt8QMH
Vjd5g5ip7GHw1JyUxcMlzAu+cPqabWRrVCjBvKW8CRvjVRbcwHCpbfJbxM/F
9qz42k4uXsslsWj09gOfys1pnH2SfGO/5yePU12a0h1yxhKuwN4EXYOt3XQd
Ngm/ND6y0Hg8ge9ds9M4uj84gxUpswFfKvnzWNQfM2HKXb6KM2+/7QUdK6sv
0nXg2gJPgVOTNyM4YXOe0Lus7PO9z4U3xJ1uzDl0enDydeAcl6mkAXwWWw5i
fdvjFf4D7J3hXw==
  "]]
},
WindowSize->{1440, 851},
WindowMargins->{{3, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 442, 8, 87, "Text"],
Cell[1002, 30, 270, 6, 35, "Text"],
Cell[1275, 38, 727, 14, 46, "Input"],
Cell[2005, 54, 457, 11, 46, "Input"],
Cell[2465, 67, 1156, 32, 97, "Input"],
Cell[3624, 101, 1624, 31, 46, "Input"],
Cell[5251, 134, 3557, 85, 84, "Input"],
Cell[8811, 221, 1791, 52, 67, "Input"],
Cell[10605, 275, 3701, 69, 102, "Input"],
Cell[14309, 346, 508, 12, 46, "Input"],
Cell[14820, 360, 2008, 40, 63, "Input"],
Cell[16831, 402, 326, 9, 46, "Input"],
Cell[17160, 413, 727, 15, 46, "Input"],
Cell[17890, 430, 1773, 46, 63, "Input"],
Cell[19666, 478, 1889, 49, 63, "Input"],
Cell[21558, 529, 1129, 28, 63, "Input"],
Cell[22690, 559, 1265, 32, 63, "Input"],
Cell[23958, 593, 2097, 55, 63, "Input"],
Cell[26058, 650, 2128, 55, 63, "Input"]
}
]
*)

(* End of internal cache information *)
